#{extends 'main.html' /}
#{set title:'urbantags' /}

#{set 'moreStyles'}
  <link rel="stylesheet" type="text/css" href="@{'/public/stylesheets/wizard/place/placeWizard.css'}" />
  <link rel="stylesheet" type="text/css" href="@{'/public/stylesheets/wizard/info/infoWizard.css'}" />
  <link rel="stylesheet" type="text/css" href="@{'/public/stylesheets/infoList.css'}" />
#{/set}

#{set 'moreScripts'}
<script type="text/javascript" src="@{'/public/javascripts/Class.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/CanFireEvents.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/EventRegistration.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/PlaceManager.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/Map.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/PlaceWizard.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/InfoWizard.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/MapBox.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/PlaceSummary.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/PlaceList.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/PlaceSheet.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/InfoList.js'}"></script>

#{jsRoutes /}

<script type="text/javascript">
placeManager = {};
placeWizard = {};
infoWizard = {};
placeSummary = {};
placeList = {};
map = {};
placeSheet = {};

$(function(){
    "use strict";
  infoWizard = new InfoWizard();
  placeManager = new PlaceManager();
  placeWizard = new PlaceWizard(placeManager);
  infoWizard = new InfoWizard();
  placeSheet = new PlaceSheet({'placeManager': placeManager, 'container': $("#place-sheet-container")});
  // placeSummary = new PlaceSummary(placeManager, infoWizard);
  placeList = new PlaceList(placeManager, placeWizard);
  placeList.refresh();
  map = new Map(placeManager, 'map');
  map.osmMap.zoomTo(5);
  placeManager.loadData();


  $("#place-sheet-container").bind('mouseover', function()
    {
        if(placeManager.selectedPlace !== null)
        {
            map.reduceMap();
            $("#place-selection-container").unbind('mouseover');
            $("#place-selection-container").bind('mouseover', function()
            {
                map.growMap();
            }.bind(this));
        }
    }.bind(this));
});
</script>
#{/set}

#{topBar user:user, userId:userId /}
    
   <div class="fluid-container" id="main-container">
       <div class="row-fluid" id="place-selection-container">
           <div class="span3" id="place-list-container">
               #{placeList user:user /}
           </div>
           <div class="span9 fluid-container">
               <div class="row-fluid">
               #{map /}
               </div>
           </div>
       </div>
       <div class="row-fluid" id="place-sheet-container" style="padding-top: 15px;">
       </div>
   </div>